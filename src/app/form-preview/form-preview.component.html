<div class="app-form-preview">
  @if (sections.length > 0) {
  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    @for (section of sections; track $index) {
    <div class="form-row">
      @for (field of section.fields; track $index) {
      <div [ngClass]="'field-size-' + (field.json.fieldSize || 'full')">
        <div [ngSwitch]="field.json.fieldType">
          <!-- Short Text Field -->
          @if (field.json.fieldType === actionTypes.shortText) {
          <label>
            {{ field.json.fieldLabel }}
            @if (field.json.isRequired) {
            <span class="required-star">*</span>
            }
          </label>
          <input
            type="text"
            [formControlName]="field.json.fieldName"
            [placeholder]="field.json.placeholderText || ''"
          />
          @if (form.get(field.json.fieldName)?.touched &&
          form.get(field.json.fieldName)?.errors) {
          <div class="error-msg">
            @if (form.get(field.json.fieldName)?.hasError('required')) {
            <div>This field is required.</div>
            } @if (form.get(field.json.fieldName)?.hasError('email')) {
            <div>Please enter a valid email address.</div>
            } @if (form.get(field.json.fieldName)?.hasError('minlength')) {
            <div>Minimum {{ field.json.minRange }} characters required.</div>
            } @if (form.get(field.json.fieldName)?.hasError('maxlength')) {
            <div>Maximum {{ field.json.maxRange }} characters allowed.</div>
            }
          </div>
          } }

          <!-- Dropdown -->
          @if (field.json.fieldType === actionTypes.dropDownList) {
          <label>
            {{ field.json.fieldLabel }}
            @if (field.json.isRequired) {
            <span class="required-star">*</span>
            }
          </label>
          <select [formControlName]="field.json.fieldName">
            <option value="">-- Select --</option>
            @for (opt of field.json.options; track $index) {
            <option [value]="opt.value">{{ opt.label }}</option>
            }
          </select>
          @if (form.get(field.json.fieldName)?.touched &&
          form.get(field.json.fieldName)?.errors) {
          <div class="error-msg">
            @if (form.get(field.json.fieldName)?.hasError('required')) {
            <div>This field is required.</div>
            }
          </div>
          } }

          <!-- Checkbox -->
          @if (field.json.fieldType === actionTypes.checkbox) {
          <label>{{ field.json.fieldLabel }}</label>
          <div class="checkbox-vertical">
            @for (option of field.json.options; track $index) {
            <label>
              <input
                type="checkbox"
                [formControlName]="field.json.fieldName"
                [value]="option.value"
              />
              {{ option.label }}
            </label>
            } @if (form.get(field.json.fieldName)?.touched &&
            form.get(field.json.fieldName)?.errors) {
            <div class="error-msg">
              @if (form.get(field.json.fieldName)?.hasError('required')) {
              <div>This field is required.</div>
              }
            </div>
            }
          </div>
          }

          <!-- Radio Group -->
          @if (field.json.fieldType === actionTypes.radioGroup) {
          <label>
            {{ field.json.fieldLabel }}
            @if (field.json.isRequired) {
            <span class="required-star">*</span>
            }
          </label>
          <div [ngClass]="['radio-group', field.json.direction || 'vertical']">
            @for (opt of field.json.options; track $index) {
            <label>
              <input
                type="radio"
                [value]="opt.value"
                [formControlName]="field.json.fieldName"
              />
              {{ opt.label }}
            </label>
            }
          </div>
          @if (form.get(field.json.fieldName)?.touched &&
          form.get(field.json.fieldName)?.errors) {
          <div class="error-msg">
            @if (form.get(field.json.fieldName)?.hasError('required')) {
            <div>This field is required.</div>
            }
          </div>
          } }

          <!-- Label -->
          @if (field.json.fieldType === actionTypes.label) {
          <p class="static-label">{{ field.json.defaultValue }}</p>
          }
        </div>
      </div>
      }
    </div>
    }

    <div class="form-actions">
      <button type="submit" class="submit-btn">Submit</button>
    </div>
  </form>
  }
</div>
