<div class="app-form-preview">
  <form [formGroup]="form" (ngSubmit)="onSubmit()" *ngIf="schema">
    <h2>{{ schema.title }}</h2>

    <div class="form-row">
      <ng-container *ngFor="let field of schema.fields">
        <div [ngClass]="'field-size-' + (field.size || 'full')">
          <div [ngSwitch]="field.type">
            <!-- TEXT -->
            <ng-container *ngSwitchCase="'text'">
              <label>
                {{ field.label }}
                <span *ngIf="field.required" class="required-star">*</span>
              </label>
              <input
                type="text"
                [formControlName]="field.name"
                [placeholder]="field.placeholder || ''"
              />
              <div
                class="error-msg"
                *ngIf="
                  form.get(field.name)?.touched && form.get(field.name)?.errors
                "
              >
                <div *ngIf="form.get(field.name)?.hasError('required')">
                  This field is required.
                </div>
                <div *ngIf="form.get(field.name)?.hasError('email')">
                  Please enter a valid email address.
                </div>
                <div *ngIf="form.get(field.name)?.hasError('minlength')">
                  Minimum {{ field.minValue }} characters required.
                </div>
                <div *ngIf="form.get(field.name)?.hasError('maxlength')">
                  Maximum {{ field.maxValue }} characters allowed.
                </div>
              </div>
            </ng-container>

            <!-- SELECT -->
            <ng-container *ngSwitchCase="'select'">
              <label>
                {{ field.label }}
                <span *ngIf="field.required" class="required-star">*</span>
              </label>
              <select [formControlName]="field.name">
                <option value="">-- Select --</option>
                <option *ngFor="let opt of field.options" [value]="opt">
                  {{ opt }}
                </option>
              </select>
              <div
                class="error-msg"
                *ngIf="
                  form.get(field.name)?.touched && form.get(field.name)?.errors
                "
              >
                <div *ngIf="form.get(field.name)?.hasError('required')">
                  This field is required.
                </div>
              </div>
            </ng-container>

            <!-- RADIO -->
            <ng-container *ngSwitchCase="'radio'">
              <label>
                {{ field.label }}
                <span *ngIf="field.required" class="required-star">*</span>
              </label>
              <div
                [ngClass]="[
                  'radio-group',
                  field.direction === 'horizontal' ? 'horizontal' : 'vertical'
                ]"
              >
                <label *ngFor="let opt of field.options">
                  <input
                    type="radio"
                    [value]="opt"
                    [formControlName]="field.name"
                  />
                  {{ opt }}
                </label>
              </div>
              <div
                class="error-msg"
                *ngIf="
                  form.get(field.name)?.touched && form.get(field.name)?.errors
                "
              >
                <div *ngIf="form.get(field.name)?.hasError('required')">
                  This field is required.
                </div>
              </div>
            </ng-container>

            <!-- CHECKBOX -->
            <ng-container *ngSwitchCase="'checkbox'">
              <label>
                <input type="checkbox" [formControlName]="field.name" />
                {{ field.label }}
                <span *ngIf="field.required" class="required-star">*</span>
              </label>
              <div
                class="error-msg"
                *ngIf="
                  form.get(field.name)?.touched && form.get(field.name)?.errors
                "
              >
                <div *ngIf="form.get(field.name)?.hasError('required')">
                  This field is required.
                </div>
              </div>
            </ng-container>
          </div>
        </div>
      </ng-container>
    </div>

    <button type="submit">Submit</button>
  </form>
</div>
